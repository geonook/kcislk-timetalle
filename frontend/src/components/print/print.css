/* ========================================
   KCISLK Timetable - Professional Print Redesign
   專業 A4 列印版型（現代學術優雅風格）
   Design Theme: Modern Academic Elegance
   Version: 2.0
   ======================================== */

/* 平時隱藏列印組件 */
.printable-timetable {
  display: none;
}

/* 列印時顯示 */
@media print {
  /* ========================================
     Page Setup & Base Styles
     ======================================== */

  /* 隱藏整個 React 應用 */
  #root {
    display: none !important;
  }

  /* 只顯示列印組件 */
  .printable-timetable {
    display: block !important;
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    width: 100% !important;
    min-height: 100vh !important;
    background: white !important;
  }

  /* 頁面設定：A4 直式，7mm 邊界（更充實） */
  @page {
    size: A4 portrait;
    margin: 7mm 10mm;
  }

  /* 強制列印顏色 */
  * {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    color-adjust: exact !important;
    box-sizing: border-box;
  }

  body {
    margin: 0;
    padding: 0;
    font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Helvetica Neue',
                 'Microsoft JhengHei', '微軟正黑體', Arial, sans-serif;
    font-size: 9pt;
    line-height: 1.4;
    color: #1F2937;
    background: #FFFFFF;
  }

  /* ========================================
     Header Section - Brand Identity
     ======================================== */
  .print-header {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-bottom: 3mm;
    padding-bottom: 3mm;
    border-bottom: 2pt solid #7C3AED;
    position: relative;
  }

  /* 主標題容器 */
  .print-header h1 {
    font-size: 16pt;
    font-weight: 700;
    margin: 0 0 2mm 0;
    color: #5B21B6;
    letter-spacing: 0.3pt;
    text-align: center;
    line-height: 1.3;
  }

  /* 副標題 - 列印日期 */
  .print-date {
    font-size: 8pt;
    color: #6B7280;
    margin: 0;
    font-weight: 500;
    background: #F3F4F6;
    padding: 2pt 8pt;
    border-radius: 3pt;
    letter-spacing: 0.2pt;
  }

  /* ========================================
     Table Structure - Optimized Layout
     ======================================== */
  .print-table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    table-layout: fixed;
    font-size: 9pt;
    box-shadow: 0 1pt 3pt rgba(0, 0, 0, 0.08);
    border-radius: 4pt;
    overflow: hidden;
  }

  /* Column Widths - Optimized */
  .time-column {
    width: 14%;
  }

  .day-column {
    width: 17.2%; /* (100% - 14%) ÷ 5 */
  }

  /* ========================================
     Table Header - Elegant Design
     ======================================== */
  .print-table thead th {
    background: linear-gradient(135deg, #7C3AED 0%, #5B21B6 100%);
    color: #FFFFFF;
    font-weight: 700;
    font-size: 10pt;
    padding: 5pt 3pt;
    text-align: center;
    border: none;
    letter-spacing: 0.3pt;
    text-transform: uppercase;
    font-size: 9pt;
  }

  .print-table thead th:first-child {
    border-top-left-radius: 4pt;
  }

  .print-table thead th:last-child {
    border-top-right-radius: 4pt;
  }

  /* ========================================
     Time Column - Visual Prominence
     ======================================== */
  .time-cell {
    background: linear-gradient(135deg, #F9FAFB 0%, #F3F4F6 100%);
    text-align: center;
    vertical-align: middle;
    padding: 4pt 2pt;
    border-right: 1.5pt solid #E5E7EB;
    border-bottom: 0.5pt solid #E5E7EB;
  }

  .period-number {
    font-weight: 700;
    font-size: 10pt;
    color: #7C3AED;
    margin-bottom: 1.5pt;
    letter-spacing: 0.2pt;
  }

  .period-time {
    font-size: 7pt;
    color: #6B7280;
    line-height: 1.3;
    font-weight: 500;
  }

  /* ========================================
     Course Cells - Card-like Design
     ======================================== */
  .course-cell {
    padding: 5pt 3pt;
    vertical-align: top;
    border-right: 0.5pt solid #E5E7EB;
    border-bottom: 0.5pt solid #E5E7EB;
    background: #FFFFFF;
    height: 25mm;
    position: relative;
  }

  /* 移除最右側邊框 */
  .course-cell:last-child {
    border-right: none;
  }

  /* 課程資訊三行顯示 - 優化層次 */
  .course-line-1 {
    font-size: 8.5pt;
    font-weight: 700;
    color: #1F2937;
    margin-bottom: 1.5pt;
    line-height: 1.3;
    letter-spacing: 0.1pt;
  }

  .course-line-2 {
    font-size: 8pt;
    color: #7C3AED;
    font-weight: 600;
    margin-bottom: 1.5pt;
    line-height: 1.3;
  }

  .course-line-3 {
    font-size: 7pt;
    color: #6B7280;
    line-height: 1.3;
    font-weight: 500;
  }

  /* ========================================
     Empty/Free Period - Subtle Design
     ======================================== */
  .empty-cell {
    padding: 4pt;
    text-align: center;
    vertical-align: middle;
    border-right: 0.5pt solid #E5E7EB;
    border-bottom: 0.5pt solid #E5E7EB;
    background: linear-gradient(135deg, #FDFCFE 0%, #F5F3FF 100%);
  }

  .empty-cell:last-child {
    border-right: none;
  }

  .free-period {
    font-size: 8pt;
    color: #A78BFA;
    font-style: italic;
    font-weight: 600;
    letter-spacing: 0.2pt;
  }

  /* ========================================
     Footer Section - Professional Touch
     ======================================== */
  .print-footer {
    margin-top: 5mm;
    padding-top: 3mm;
    border-top: 1pt solid #E5E7EB;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .print-footer p {
    margin: 0;
    font-size: 7pt;
    color: #9CA3AF;
    font-weight: 500;
    letter-spacing: 0.3pt;
  }

  /* ========================================
     Zebra Striping - Subtle Visual Aid
     ======================================== */
  .print-table tbody tr:nth-child(even) .course-cell {
    background: #FAFAFA;
  }

  .print-table tbody tr:nth-child(even) .empty-cell {
    background: linear-gradient(135deg, #FDFCFE 0%, #F8F7FC 100%);
  }

  /* ========================================
     Page Break Control
     ======================================== */
  .print-table {
    page-break-inside: avoid;
  }

  .print-table tr {
    page-break-inside: avoid;
    page-break-after: auto;
  }

  .print-table thead {
    display: table-header-group;
  }

  .print-table tbody {
    display: table-row-group;
  }

  /* ========================================
     Edge Cases & Polish
     ======================================== */

  /* 最後一列移除底部邊框 */
  .print-table tbody tr:last-child td {
    border-bottom: none;
  }

  /* 確保表格外框完整 */
  .print-table {
    border: 1pt solid #E5E7EB;
  }

  /* ========================================
     Print Optimization
     ======================================== */

  /* 允許文字換行以顯示完整內容 */
  .course-line-1,
  .course-line-2,
  .course-line-3 {
    overflow: visible;
    word-wrap: break-word;
    word-break: break-word;
    white-space: normal;
  }

  /* 確保顏色列印 */
  .print-table thead th,
  .time-cell,
  .empty-cell,
  .period-number,
  .course-line-2 {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    color-adjust: exact !important;
  }
}

/* ========================================
   Additional Enhancements (Optional)
   ======================================== */

@media print {
  /* 如果需要加入 Logo 的樣式 */
  .print-header-logo {
    width: 40pt;
    height: auto;
    margin-bottom: 2mm;
  }

  /* 如果需要三欄式標頭 */
  .print-header-flex {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
  }

  .print-header-left {
    flex: 1;
    text-align: left;
  }

  .print-header-center {
    flex: 2;
    text-align: center;
  }

  .print-header-right {
    flex: 1;
    text-align: right;
  }

  /* 增強版頁尾（三欄式） */
  .print-footer-flex {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
  }

  .print-footer-left,
  .print-footer-center,
  .print-footer-right {
    font-size: 7pt;
    color: #9CA3AF;
  }
}
