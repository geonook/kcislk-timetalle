/* ========================================
   KCISLK Timetable - Professional Black & White Print Style
   專業黑白列印版型（加強粗體設計）
   Design Theme: Professional Monochrome with Bold Typography
   Version: 3.0
   ======================================== */

/* 平時隱藏列印組件 */
.printable-timetable {
  display: none;
}

/* 列印時顯示 */
@media print {
  /* ========================================
     強制淺色模式 + 黑白配色（優先級最高）
     ======================================== */

  html, body {
    background: #FFFFFF !important;
    color: #000000 !important;
    color-scheme: light !important;
  }

  html.dark, body.dark,
  html[class*="dark"], body[class*="dark"] {
    background: #FFFFFF !important;
    color: #000000 !important;
  }

  .dark, [class*="dark"] {
    background: transparent !important;
    color: inherit !important;
  }

  .printable-timetable,
  .printable-timetable * {
    color-scheme: light !important;
  }

  /* ========================================
     Page Setup & Base Styles
     ======================================== */

  /* 隱藏整個 React 應用 */
  #root {
    display: none !important;
  }

  /* 只顯示列印組件 */
  .printable-timetable {
    display: block !important;
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    width: 100% !important;
    min-height: 100vh !important;
    background: white !important;
  }

  /* 頁面設定：A4 橫式，7mm 邊界 */
  @page {
    size: A4 landscape;
    margin: 7mm 10mm;
  }

  /* 強制列印顏色（黑白也需要灰階） */
  * {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    color-adjust: exact !important;
    box-sizing: border-box;
  }

  body {
    margin: 0;
    padding: 0;
    font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Helvetica Neue',
                 'Microsoft JhengHei', '微軟正黑體', Arial, sans-serif;
    font-size: 9.5pt;  /* 9pt → 9.5pt */
    line-height: 1.5;   /* 1.4 → 1.5 */
    color: #000000;
    background: #FFFFFF;
  }

  /* ========================================
     Header Section - Bold & Professional
     ======================================== */
  .print-header {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-bottom: 4mm;
    padding-bottom: 4mm;
    border-bottom: 2.5pt solid #000000;  /* 紫色 → 黑色加粗 */
    position: relative;
  }

  /* 主標題 - 特大粗體 */
  .print-header h1 {
    font-size: 18pt;     /* 16pt → 18pt 更大 */
    font-weight: 800;    /* 700 → 800 更粗 */
    margin: 0 0 2mm 0;
    color: #000000 !important;  /* 紫色 → 黑色 */
    letter-spacing: 0.5pt;      /* 0.3pt → 0.5pt 更寬鬆 */
    text-align: center;
    line-height: 1.3;
    text-transform: uppercase;  /* 新增：全大寫 */
  }

  /* 副標題 - 列印日期 */
  .print-date {
    font-size: 9pt;      /* 8pt → 9pt */
    color: #4B5563 !important;  /* 深灰 */
    margin: 0;
    font-weight: 700;    /* 500 → 700 加粗 */
    background: #F3F4F6;
    padding: 3pt 10pt;   /* 2pt 8pt → 3pt 10pt */
    border-radius: 3pt;
    letter-spacing: 0.3pt;
    border: 1pt solid #D1D5DB;  /* 新增：邊框 */
  }

  /* ========================================
     Table Structure - Optimized Layout
     ======================================== */
  .print-table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    table-layout: fixed;
    font-size: 9.5pt;    /* 9pt → 9.5pt */
    box-shadow: none;    /* 移除陰影 */
    border-radius: 0;    /* 移除圓角 */
    overflow: hidden;
    border: 2pt solid #000000 !important;  /* 新增：粗黑框 */
  }

  /* Column Widths - Optimized */
  .time-column {
    width: 14%;
  }

  .day-column {
    width: 17.2%; /* (100% - 14%) ÷ 5 */
  }

  /* ========================================
     Table Header - Bold Black & White
     ======================================== */
  .print-table thead th {
    background: #000000 !important;  /* 紫色漸層 → 純黑 */
    color: #FFFFFF !important;
    font-weight: 800;    /* 700 → 800 更粗 */
    font-size: 11pt;     /* 9pt → 11pt 更大 */
    padding: 6pt 4pt;    /* 5pt 3pt → 6pt 4pt */
    text-align: center;
    border: 1pt solid #000000 !important;
    letter-spacing: 0.5pt;  /* 0.3pt → 0.5pt */
    text-transform: uppercase;
  }

  .print-table thead th:first-child {
    border-top-left-radius: 0;  /* 移除圓角 */
  }

  .print-table thead th:last-child {
    border-top-right-radius: 0;  /* 移除圓角 */
  }

  /* ========================================
     Time Column - Bold Emphasis
     ======================================== */
  .time-cell {
    background: #F9FAFB !important;  /* 淺灰背景 */
    text-align: center;
    vertical-align: middle;
    padding: 5pt 3pt;    /* 4pt 2pt → 5pt 3pt */
    border-right: 2pt solid #000000 !important;  /* 1.5pt → 2pt 加粗黑框 */
    border-bottom: 1pt solid #D1D5DB !important;
  }

  .period-number {
    font-weight: 800;    /* 700 → 800 更粗 */
    font-size: 11pt;     /* 10pt → 11pt 更大 */
    color: #000000 !important;  /* 紫色 → 黑色 */
    margin-bottom: 2pt;  /* 1.5pt → 2pt */
    letter-spacing: 0.3pt;
  }

  .period-time {
    font-size: 8pt;      /* 7pt → 8pt */
    color: #4B5563 !important;  /* 深灰 */
    line-height: 1.3;
    font-weight: 600;    /* 500 → 600 加粗 */
  }

  /* ========================================
     Course Cells - Bold Hierarchy
     ======================================== */
  .course-cell {
    padding: 6pt 4pt;    /* 5pt 3pt → 6pt 4pt */
    vertical-align: top;
    border-right: 1pt solid #D1D5DB !important;
    border-bottom: 1pt solid #D1D5DB !important;
    background: #FFFFFF !important;
    height: 26mm;        /* 25mm → 26mm */
    position: relative;
  }

  /* 移除最右側邊框 */
  .course-cell:last-child {
    border-right: none;
  }

  /* 課程資訊三行顯示 - 加強粗體層次 */
  .course-line-1 {
    font-size: 9pt;       /* 8.5pt → 9pt 更大 */
    font-weight: 800;     /* 700 → 800 更粗 */
    color: #000000 !important;
    margin-bottom: 2pt;   /* 1.5pt → 2pt */
    line-height: 1.3;
    letter-spacing: 0.2pt;  /* 0.1pt → 0.2pt */
  }

  .course-line-2 {
    font-size: 8.5pt;     /* 8pt → 8.5pt 更大 */
    color: #1F2937 !important;  /* 紫色 → 深灰 */
    font-weight: 700;     /* 600 → 700 加粗 */
    margin-bottom: 2pt;   /* 1.5pt → 2pt */
    line-height: 1.3;
  }

  .course-line-3 {
    font-size: 7.5pt;     /* 7pt → 7.5pt 更大 */
    color: #4B5563 !important;  /* 中灰 */
    line-height: 1.3;
    font-weight: 600;     /* 500 → 600 加粗 */
  }

  /* ========================================
     Empty/Free Period - Subtle Design
     ======================================== */
  .empty-cell {
    padding: 5pt;        /* 4pt → 5pt */
    text-align: center;
    vertical-align: middle;
    border-right: 1pt solid #D1D5DB !important;
    border-bottom: 1pt solid #D1D5DB !important;
    background: #F9FAFB !important;  /* 淺灰背景 */
  }

  .empty-cell:last-child {
    border-right: none;
  }

  .free-period {
    font-size: 8.5pt;    /* 8pt → 8.5pt */
    color: #9CA3AF !important;  /* 淺灰 */
    font-style: italic;
    font-weight: 700;    /* 600 → 700 加粗 */
    letter-spacing: 0.3pt;
  }

  /* ========================================
     Footer Section - Professional Touch
     ======================================== */
  .print-footer {
    margin-top: 5mm;
    padding-top: 3mm;
    border-top: 2pt solid #000000 !important;  /* 1pt → 2pt 加粗黑線 */
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .print-footer p {
    margin: 0;
    font-size: 8pt;      /* 7pt → 8pt */
    color: #6B7280 !important;  /* 深灰 */
    font-weight: 700;    /* 500 → 700 加粗 */
    letter-spacing: 0.4pt;  /* 0.3pt → 0.4pt */
  }

  /* ========================================
     Zebra Striping - Subtle Black & White
     ======================================== */
  .print-table tbody tr:nth-child(even) .course-cell {
    background: #F9FAFB !important;  /* 淺灰斑馬紋 */
  }

  .print-table tbody tr:nth-child(even) .empty-cell {
    background: #F3F4F6 !important;  /* 稍深灰 */
  }

  /* ========================================
     Page Break Control
     ======================================== */
  .print-table {
    page-break-inside: avoid;
  }

  .print-table tr {
    page-break-inside: avoid;
    page-break-after: auto;
  }

  .print-table thead {
    display: table-header-group;
  }

  .print-table tbody {
    display: table-row-group;
  }

  /* ========================================
     Edge Cases & Polish
     ======================================== */

  /* 最後一列移除底部邊框 */
  .print-table tbody tr:last-child td {
    border-bottom: none;
  }

  /* 確保表格外框完整（粗黑框） */
  .print-table {
    border: 2pt solid #000000 !important;
  }

  /* ========================================
     Print Optimization
     ======================================== */

  /* 允許文字換行以顯示完整內容 */
  .course-line-1,
  .course-line-2,
  .course-line-3 {
    overflow: visible;
    word-wrap: break-word;
    word-break: break-word;
    white-space: normal;
  }

  /* 強制黑白顏色（包含灰階） */
  .print-table thead th,
  .time-cell,
  .empty-cell,
  .period-number,
  .course-line-1,
  .course-line-2,
  .course-line-3,
  .print-header h1,
  .print-footer p {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    color-adjust: exact !important;
  }
}

/* ========================================
   Additional Enhancements (Optional)
   ======================================== */

@media print {
  /* 如果需要加入 Logo 的樣式 */
  .print-header-logo {
    width: 40pt;
    height: auto;
    margin-bottom: 2mm;
  }

  /* 如果需要三欄式標頭 */
  .print-header-flex {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
  }

  .print-header-left {
    flex: 1;
    text-align: left;
  }

  .print-header-center {
    flex: 2;
    text-align: center;
  }

  .print-header-right {
    flex: 1;
    text-align: right;
  }

  /* 增強版頁尾（三欄式） */
  .print-footer-flex {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
  }

  .print-footer-left,
  .print-footer-center,
  .print-footer-right {
    font-size: 8pt;      /* 7pt → 8pt */
    color: #6B7280 !important;
    font-weight: 700;    /* 新增：加粗 */
  }
}
